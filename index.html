<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор выбора технологии производства БПЛА</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            background-color: #f4f4f9;
            color: #333;
            padding: 2vw;
            font-size: calc(14px + 0.5vw);
        }

        .container {
            max-width: 1200px;
            width: 95%;
            margin: 0 auto;
            background: #fff;
            padding: 3vw;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 {
            color: #2c3e50;
        }

        h1 {
            text-align: center;
            margin-bottom: 4vw;
            font-size: calc(20px + 1.5vw);
        }

        h2 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 1vw;
            margin: 4vw 0 2vw;
            font-size: calc(16px + 1vw);
        }

        .input-group {
            margin-bottom: 2.5vw;
        }

        label {
            display: block;
            margin-bottom: 1vw;
            font-weight: bold;
            font-size: calc(12px + 0.5vw);
        }

        input, select {
            width: 100%;
            padding: 2vw;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: calc(12px + 0.5vw);
        }

        button {
            background: #3498db;
            color: #fff;
            border: none;
            padding: 2.5vw 3vw;
            border-radius: 4px;
            cursor: pointer;
            font-size: calc(14px + 0.5vw);
            width: 100%;
            margin-top: 2vw;
            touch-action: manipulation;
        }

        button:hover {
            background: #2980b9;
        }

        .result-section {
            margin-top: 3vw;
            padding: 3vw;
            background: #e8f4fc;
            border-radius: 4px;
        }

        .hidden {
            display: none;
        }

        .recommended-tech {
            font-weight: bold;
            color: #27ae60;
            font-size: calc(16px + 0.5vw);
        }

        .formula {
            background-color: #f9f9f9;
            border-left: 4px solid #3498db;
            padding: 2vw 3vw;
            margin: 2.5vw 0;
            font-family: monospace;
            font-size: calc(12px + 0.5vw);
            overflow-x: auto;
        }

        .tech-comparison {
            width: 100%;
            border-collapse: collapse;
            margin: 2.5vw 0;
        }

        .tech-comparison th, .tech-comparison td {
            border: 1px solid #ddd;
            padding: 2vw;
            text-align: left;
            font-size: calc(12px + 0.5vw);
        }

        .tech-comparison th {
            background-color: #3498db;
            color: white;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .tech-comparison tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .tab {
            overflow-x: auto;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
            border-radius: 4px 4px 0 0;
            display: flex;
        }

        .tab button {
            background-color: inherit;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 2vw 3vw;
            transition: background-color 0.3s;
            color: #333;
            flex: 1;
            text-align: center;
            font-size: calc(12px + 0.5vw);
        }

        .tab button:hover {
            background-color: #ddd;
        }

        .tab button.active {
            background-color: #3498db;
            color: white;
        }

        .tabcontent {
            display: none;
            padding: 3vw;
            border: 1px solid #ccc;
            border-top: none;
            border-radius: 0 0 4px 4px;
        }

        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2.5vw 0;
            display: block;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .metrics-table th, .metrics-table td {
            border: 1px solid #ddd;
            padding: 1.5vw;
            text-align: left;
            font-size: calc(11px + 0.5vw);
            min-width: 120px;
        }

        .metrics-table th {
            background-color: #3498db;
            color: white;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .metrics-table td.criterion {
            font-weight: bold;
            background-color: #e8f4fc;
        }

        .metrics-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        @media (max-width: 768px) {
            body {
                padding: 4vw;
                font-size: calc(12px + 1vw);
            }

            .container {
                width: 100%;
                padding: 4vw;
            }

            h1 {
                font-size: calc(16px + 2vw);
                margin-bottom: 6vw;
            }

            h2 {
                font-size: calc(14px + 1.5vw);
                margin: 6vw 0 3vw;
            }

            label {
                font-size: calc(10px + 1vw);
            }

            input, select {
                padding: 3vw;
                font-size: calc(10px + 1vw);
            }

            button {
                padding: 3.5vw 4vw;
                font-size: calc(12px + 1vw);
            }

            .tech-comparison, .metrics-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }

            .tech-comparison th, .tech-comparison td,
            .metrics-table th, .metrics-table td {
                padding: 2.5vw;
                font-size: calc(10px + 1vw);
                min-width: 100px;
            }

            .tab button {
                padding: 3vw 2vw;
                font-size: calc(10px + 1vw);
            }

            .formula {
                font-size: calc(10px + 1vw);
                padding: 3vw;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: calc(14px + 2.5vw);
            }

            h2 {
                font-size: calc(12px + 2vw);
            }

            button {
                padding: 4vw 5vw;
            }

            .input-group {
                margin-bottom: 4vw;
            }

            .metrics-table th, .metrics-table td {
                padding: 3vw;
                font-size: calc(9px + 1vw);
                min-width: 80px;
            }
        }

        @media (min-width: 769px) {
            .tabcontent {
                animation: fadeEffect 1s;
            }

            @keyframes fadeEffect {
                from { opacity: 0; }
                to { opacity: 1; }
            }

            .metrics-table th, .metrics-table td {
                padding: 1vw;
                font-size: calc(12px + 0.5vw);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Калькулятор выбора технологии производства БПЛА</h1>
        
        <div class="tab">
            <button class="tablinks active" onclick="openTab(event, 'Comparison')">Сравнение подходов</button>
            <button class="tablinks" onclick="openTab(event, 'AdditiveSelection')">Выбор аддитивной технологии</button>
            <button class="tablinks" onclick="openTab(event, 'Info')">Информация и метрики</button>
        </div>

        <!-- Вкладка 1: Сравнение аддитивного и традиционного производства -->
        <div id="Comparison" class="tabcontent" style="display: block;">
            <h2>Сравнение аддитивного и традиционного производства</h2>
            <form id="comparisonForm">
                <div class="input-group">
                    <label for="droneType">Тип БПЛА:</label>
                    <select id="droneType" required>
                        <option value="multicopter">Мультикоптер</option>
                        <option value="singlerotor">Однороторный дрон</option>
                        <option value="fixedwing" selected>С неподвижным крылом</option>
                        <option value="hybrid">Гибридный дрон</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="tTraditional">Время производства (традиционное, дни):</label>
                    <input type="number" id="tTraditional" min="1" value="30" required>
                </div>
                <div class="input-group">
                    <label for="tAM">Время производства (аддитивное, дни):</label>
                    <input type="number" id="tAM" min="1" value="5" required>
                </div>
                <div class="input-group">
                    <label for="cFlex">Стоимость перенастройки (руб.):</label>
                    <input type="number" id="cFlex" min="0" value="1000000" required>
                </div>
                <div class="input-group">
                    <label for="cTotal">Общая стоимость (руб.):</label>
                    <input type="number" id="cTotal" min="1" value="5000000" required>
                </div>
                <div class="input-group">
                    <label for="wasteAM">Отходы (аддитивное, %):</label>
                    <input type="number" id="wasteAM" min="0" max="100" value="1" step="0.1" required>
                </div>
                <div class="input-group">
                    <label for="wasteTraditional">Отходы (традиционное, %):</label>
                    <input type="number" id="wasteTraditional" min="0" max="100" value="10" step="0.1" required>
                </div>
                <div class="input-group">
                    <label for="co2AM">Выбросы CO2 (аддитивное, кг/тонну):</label>
                    <input type="number" id="co2AM" min="0" value="1" step="0.1" required>
                </div>
                <div class="input-group">
                    <label for="co2Traditional">Выбросы CO2 (традиционное, кг/тонну):</label>
                    <input type="number" id="co2Traditional" min="0" value="10" step="0.1" required>
                </div>
                <div class="input-group">
                    <label for="kAM">Коэффициент автоматизации (аддитивное, 0–1):</label>
                    <input type="number" id="kAM" min="0" max="1" value="0.8" step="0.01" required>
                </div>
                <div class="input-group">
                    <label for="opsAM">Количество операций (аддитивное):</label>
                    <input type="number" id="opsAM" min="1" value="2" required>
                </div>
                <div class="input-group">
                    <label for="opsTraditional">Количество операций (традиционное):</label>
                    <input type="number" id="opsTraditional" min="1" value="7" required>
                </div>
                <div class="input-group">
                    <label for="precisionAM">Точность (аддитивное, мм):</label>
                    <input type="number" id="precisionAM" min="0" value="0.1" step="0.01" required>
                </div>
                <div class="input-group">
                    <label for="repeatAM">Повторяемость (аддитивное, %):</label>
                    <input type="number" id="repeatAM" min="0" max="100" value="95" step="0.1" required>
                </div>
                <div class="input-group">
                    <label for="setupAM">Время установки (аддитивное, дни):</label>
                    <input type="number" id="setupAM" min="1" value="10" required>
                </div>
                <div class="input-group">
                    <label for="setupTraditional">Время установки (традиционное, дни):</label>
                    <input type="number" id="setupTraditional" min="1" value="90" required>
                </div>
                <div class="input-group">
                    <label for="durabilityAM">Долговечность линии (аддитивное, годы):</label>
                    <input type="number" id="durabilityAM" min="1" value="10" required>
                </div>
                <div class="input-group">
                    <label for="ecoMatAM">Экологичные материалы (аддитивное, %):</label>
                    <input type="number" id="ecoMatAM" min="0" max="100" value="30" step="0.1" required>
                </div>
                <button type="button" onclick="calculateComparison()">Рассчитать</button>
            </form>

            <div id="comparisonResult" class="result-section hidden">
                <h3>Результат сравнения:</h3>
                <p id="efficiencyValue"></p>
                <p id="efficiencyInterpretation"></p>
                <h3>Сравнительная таблица:</h3>
                <table class="tech-comparison">
                    <tr>
                        <th>Показатель</th>
                        <th>Аддитивное</th>
                        <th>Традиционное</th>
                    </tr>
                    <tr>
                        <td>Время (дни)</td>
                        <td id="compTimeAM"></td>
                        <td id="compTimeTraditional"></td>
                    </tr>
                    <tr>
                        <td>Отходы (%)</td>
                        <td id="compWasteAM"></td>
                        <td id="compWasteTraditional"></td>
                    </tr>
                    <tr>
                        <td>Выбросы CO2 (кг/тонну)</td>
                        <td id="compCO2AM"></td>
                        <td id="compCO2Traditional"></td>
                    </tr>
                    <tr>
                        <td>Количество операций</td>
                        <td id="compOpsAM"></td>
                        <td id="compOpsTraditional"></td>
                    </tr>
                    <tr>
                        <td>Себестоимость (руб.)</td>
                        <td id="compCostAM"></td>
                        <td id="compCostTraditional"></td>
                    </tr>
                    <tr>
                        <td>Точность (мм)</td>
                        <td id="compPrecisionAM"></td>
                        <td id="compPrecisionTraditional"></td>
                    </tr>
                    <tr>
                        <td>Повторяемость (%)</td>
                        <td id="compRepeatAM"></td>
                        <td id="compRepeatTraditional"></td>
                    </tr>
                    <tr>
                        <td>Маневренность (1/дни)</td>
                        <td id="compSetupAM"></td>
                        <td id="compSetupTraditional"></td>
                    </tr>
                    <tr>
                        <td>Долговечность (годы)</td>
                        <td id="compDurabilityAM"></td>
                        <td id="compDurabilityTraditional"></td>
                    </tr>
                    <tr>
                        <td>Экологичные материалы (%)</td>
                        <td id="compEcoMatAM"></td>
                        <td id="compEcoMatTraditional"></td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Вкладка 2: Выбор аддитивной технологии -->
        <div id="AdditiveSelection" class="tabcontent">
            <h2>Выбор аддитивной технологии</h2>
            <form id="additiveForm">
                <div class="input-group">
                    <label for="droneTypeAdd">Тип БПЛА:</label>
                    <select id="droneTypeAdd" required>
                        <option value="multicopter">Мультикоптер</option>
                        <option value="singlerotor">Однороторный дрон</option>
                        <option value="fixedwing" selected>С неподвижным крылом</option>
                        <option value="hybrid">Гибридный дрон</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="productionVolume">Объем производства (шт./год):</label>
                    <input type="number" id="productionVolume" min="1" value="100" required>
                </div>
                <div class="input-group">
                    <label for="timeConstraint">Срок производства (дни):</label>
                    <input type="number" id="timeConstraint" min="1" value="7" required>
                </div>
                <div class="input-group">
                    <label for="budget">Бюджет:</label>
                    <select id="budget" required>
                        <option value="low">Низкий</option>
                        <option value="medium" selected>Средний</option>
                        <option value="high">Высокий</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="material">Материал:</label>
                    <select id="material" required>
                        <option value="plastic">Пластик (PLA, ABS)</option>
                        <option value="nylon">Нейлон (PA12)</option>
                        <option value="metal">Металл (титан, алюминий)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="complexity">Сложность геометрии:</label>
                    <select id="complexity" required>
                        <option value="low">Простая</option>
                        <option value="medium" selected>Средняя</option>
                        <option value="high">Высокая</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="ecoPriority">Экологичность (приоритет):</label>
                    <select id="ecoPriority" required>
                        <option value="low">Низкий</option>
                        <option value="medium" selected>Средний</option>
                        <option value="high">Высокий</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="precisionPriority">Точность (приоритет):</label>
                    <select id="precisionPriority" required>
                        <option value="low">Низкий</option>
                        <option value="medium" selected>Средний</option>
                        <option value="high">Высокий</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="setupTime">Время установки (дни):</label>
                    <input type="number" id="setupTime" min="1" value="10" required>
                </div>
                <div class="input-group">
                    <label for="durability">Долговечность линии (годы):</label>
                    <input type="number" id="durability" min="1" value="10" required>
                </div>
                <div class="input-group">
                    <label for="adjustTime">Время отладки (недели):</label>
                    <input type="number" id="adjustTime" min="1" value="5" required>
                </div>
                <button type="button" onclick="calculateAdditive()">Рассчитать</button>
            </form>

            <div id="additiveResult" class="result-section hidden">
                <h3>Рекомендуемая технология:</h3>
                <p class="recommended-tech" id="recommendedTech"></p>
                <p id="techExplanation"></p>
                <h3>Веса критериев (AHP):</h3>
                <p id="criteriaWeights"></p>
                <h3>Альтернативные варианты:</h3>
                <div id="alternatives"></div>
            </div>
        </div>

        <!-- Вкладка 3: Информация и метрики -->
        <div id="Info" class="tabcontent">
            <h2>Информация и метрики</h2>
            <h3>Метрики КПЭ</h3>
            <table class="metrics-table">
                <tr>
                    <th>Критерий/Показатель</th>
                    <th>Формула/Описание</th>
                    <th>Диапазон</th>
                    <th>Целевое значение</th>
                </tr>
                <tr>
                    <td class="criterion">Тип БПЛА</td>
                    <td>Мультикоптеры, однороторные, неподвижное крыло, гибридные</td>
                    <td>1–4</td>
                    <td>Зависит от требований</td>
                </tr>
                <tr>
                    <td class="criterion">Скорость производства</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>Повторяемость линии (%)</td>
                    <td>R = N<sub>success</sub> / N<sub>total</sub> × 100</td>
                    <td>90–95%</td>
                    <td>95%</td>
                </tr>
                <tr>
                    <td>Время на изделие (мин)</td>
                    <td>T<sub>item</sub> = T<sub>total</sub> / N</td>
                    <td>15 мин – 2 дня</td>
                    <td>60 мин</td>
                </tr>
                <tr>
                    <td>Долговечность линии (лет)</td>
                    <td>Срок службы оборудования</td>
                    <td>1–10 лет</td>
                    <td>20 лет</td>
                </tr>
                <tr>
                    <td>Простота производства (операций)</td>
                    <td>O = число операций</td>
                    <td>AM: 1–3, Trad: 5–10</td>
                    <td>≤3</td>
                </tr>
                <tr>
                    <td class="criterion">Удобство установки</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>Маневренность установки (1/дни)</td>
                    <td>M = 1 / T<sub>setup</sub></td>
                    <td>AM: 0.033–0.333, Trad: 0.003–0.011</td>
                    <td>0.033</td>
                </tr>
                <tr>
                    <td>Коэффициент автоматизации</td>
                    <td>K = N<sub>uni</sub> / N<sub>total</sub></td>
                    <td>0–1</td>
                    <td>0.6–0.8</td>
                </tr>
                <tr>
                    <td>Время отладки (недели)</td>
                    <td>T<sub>adjust</sub></td>
                    <td>2–12 недель</td>
                    <td>5 недель</td>
                </tr>
                <tr>
                    <td class="criterion">Себестоимость изделий</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>Затраты на изделие (руб.)</td>
                    <td>C = C<sub>мат</sub> + C<sub>энер</sub> + C<sub>труд</sub></td>
                    <td>150,000–6,000,000</td>
                    <td>150,000–200,000</td>
                </tr>
                <tr>
                    <td>Стоимость линии (руб.)</td>
                    <td>C<sub>line</sub></td>
                    <td>3,000,000–30,000,000</td>
                    <td>3,000,000</td>
                </tr>
                <tr>
                    <td>Объем выпуска (шт./год)</td>
                    <td>N<sub>year</sub></td>
                    <td>AM: 10–500, Trad: 1,000–10,000</td>
                    <td>5,000</td>
                </tr>
                <tr>
                    <td class="criterion">Экологичность производства</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>Выбросы CO2 (кг/тонну)</td>
                    <td>E<sub>CO2</sub> = M<sub>CO2</sub> / M<sub>prod</sub></td>
                    <td>1–15</td>
                    <td>< 1</td>
                </tr>
                <tr>
                    <td>Отходы (%)</td>
                    <td>W<sub>отх</sub> = M<sub>отх</sub> / M<sub>всего</sub> × 100</td>
                    <td>1–20%</td>
                    <td>1%</td>
                </tr>
                <tr>
                    <td>Экологичные материалы (%)</td>
                    <td>P<sub>eco</sub> = M<sub>eco</sub> / M<sub>total</sub> × 100</td>
                    <td>10–50%</td>
                    <td>30%</td>
                </tr>
                <tr>
                    <td class="criterion">Механо-технические свойства</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>Усадка материала (%)</td>
                    <td>S = ΔV / V<sub>0</sub> × 100</td>
                    <td>0.2–5%</td>
                    <td>0.2%</td>
                </tr>
                <tr>
                    <td>Сложные детали (операции)</td>
                    <td>O<sub>geom</sub></td>
                    <td>1–5</td>
                    <td>1–2</td>
                </tr>
                <tr>
                    <td>Изменение свойств (%)</td>
                    <td>ΔP = |P<sub>final</sub> - P<sub>init</sub>| / P<sub>init</sub> × 100</td>
                    <td>AM: 0.1–10%, Trad: 0.2–0.5%</td>
                    <td>0.1%</td>
                </tr>
                <tr>
                    <td>Точность производства (мм)</td>
                    <td>ΔD</td>
                    <td>0.01–0.5 мм</td>
                    <td>0.01 мм</td>
                </tr>
                <tr>
                    <td>Разнообразие материалов</td>
                    <td>N<sub>mat</sub></td>
                    <td>5–50</td>
                    <td>20</td>
                </tr>
            </table>

            <h3>Формулы</h3>
            <div class="formula">
                E<sub>adapt</sub> = α · (T<sub>trad</sub> - T<sub>AM</sub>)/T<sub>trad</sub> + β · C<sub>flex</sub>/C<sub>total</sub> + γ · ln(1 + N<sub>design</sub>/N<sub>trad</sub>) + δ · (W<sub>trad</sub> - W<sub>AM</sub>)/W<sub>trad</sub> + ε · K<sub>AM</sub> + ζ · (O<sub>trad</sub> - O<sub>AM</sub>)/O<sub>trad</sub> + η · P<sub>target</sub>/P<sub>AM</sub> + θ · (CO2<sub>trad</sub> - CO2<sub>AM</sub>)/CO2<sub>trad</sub> + ι · M<sub>AM</sub>/M<sub>target</sub> + κ · R<sub>AM</sub>
                <br>Где: α=0.2, β=0.15, γ=0.1, δ=0.1, ε=0.1, ζ=0.1, η=0.1, θ=0.1, ι=0.05, κ=0.05
            </div>
            <div class="formula">
                R = N<sub>success</sub> / N<sub>total</sub> × 100
                <br>Повторяемость линии (%, целевое: 95%)
            </div>
            <div class="formula">
                M = 1 / T<sub>setup</sub>
                <br>Маневренность установки (1/дни, целевое: 0.033)
            </div>
            <div class="formula">
                K = N<sub>uni</sub> / N<sub>total</sub>
                <br>Коэффициент автоматизации (0–1, целевое: 0.6–0.8)
            </div>
            <div class="formula">
                W<sub>отх</sub> = M<sub>отх</sub> / M<sub>всего</sub> × 100
                <br>Доля отходов (%, целевое: 1%)
            </div>
            <div class="formula">
                E<sub>CO2</sub> = M<sub>CO2</sub> / M<sub>prod</sub>
                <br>Выбросы CO2 (кг/тонну, целевое: < 1)
            </div>
            <div class="formula">
                S = ΔV / V<sub>0</sub> × 100
                <br>Усадка материала (%, целевое: 0.2%)
            </div>
            <div class="formula">
                P<sub>eco</sub> = M<sub>eco</sub> / M<sub>total</sub> × 100
                <br>Экологичные материалы (%, целевое: 30%)
            </div>

            <h3>Пример расчета</h3>
            <p>Для корпуса БПЛА (мультикоптер, масса материала 1 кг, отходы 0.01 кг, выбросы 0.8 кг/тонну, 2 операции, точность 0.05 мм, повторяемость 95%, установка 10 дней):</p>
            <ul>
                <li>Доля отходов: W<sub>отх</sub> = 0.01 / 1 × 100 = 1%</li>
                <li>Коэффициент автоматизации: K = 8 / 10 = 0.8</li>
                <li>Выбросы: E<sub>CO2</sub> = 0.8 кг/тонну</li>
                <li>Усадка: S = 0.002 × 100 = 0.2%</li>
                <li>Повторяемость: R = 95%</li>
                <li>Маневренность: M = 1 / 10 = 0.1 1/дни</li>
                <li>Себестоимость: C = 100,000 (материалы) + 20,000 (энергия) + 30,000 (труд) = 150,000 руб.</li>
            </ul>
        </div>
    </div>

    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        function calculateComparison() {
            const droneType = document.getElementById("droneType").value;
            const tTraditional = parseFloat(document.getElementById("tTraditional").value);
            const tAM = parseFloat(document.getElementById("tAM").value);
            const cFlex = parseFloat(document.getElementById("cFlex").value);
            const cTotal = parseFloat(document.getElementById("cTotal").value);
            const wasteAM = parseFloat(document.getElementById("wasteAM").value);
            const wasteTraditional = parseFloat(document.getElementById("wasteTraditional").value);
            const co2AM = parseFloat(document.getElementById("co2AM").value);
            const co2Traditional = parseFloat(document.getElementById("co2Traditional").value);
            const kAM = parseFloat(document.getElementById("kAM").value);
            const opsAM = parseInt(document.getElementById("opsAM").value);
            const opsTraditional = parseInt(document.getElementById("opsTraditional").value);
            const precisionAM = parseFloat(document.getElementById("precisionAM").value);
            const repeatAM = parseFloat(document.getElementById("repeatAM").value) / 100;
            const setupAM = parseFloat(document.getElementById("setupAM").value);
            const setupTraditional = parseFloat(document.getElementById("setupTraditional").value);
            const durabilityAM = parseFloat(document.getElementById("durabilityAM").value);
            const ecoMatAM = parseFloat(document.getElementById("ecoMatAM").value);

            const alpha = 0.2, beta = 0.15, gamma = 0.1, delta = 0.1, epsilon = 0.1, zeta = 0.1, eta = 0.1, theta = 0.1, iota = 0.05, kappa = 0.05;
            const nDesign = 10, nTraditional = 2;
            const precisionTarget = 0.01;
            const precisionTraditional = 0.1;
            const mTarget = 0.033;
            const repeatTraditional = 0.92;
            const durabilityTraditional = 5;
            const ecoMatTraditional = 10;

            const timeComponent = alpha * (tTraditional - tAM) / tTraditional;
            const costComponent = beta * cFlex / cTotal;
            const designComponent = gamma * Math.log(1 + nDesign / nTraditional);
            const wasteComponent = delta * (wasteTraditional - wasteAM) / wasteTraditional;
            const automationComponent = epsilon * kAM;
            const opsComponent = zeta * (opsTraditional - opsAM) / opsTraditional;
            const precisionComponent = eta * (precisionTarget / precisionAM);
            const co2Component = theta * (co2Traditional - co2AM) / co2Traditional;
            const maneuverComponent = iota * ((1 / setupAM) / mTarget);
            const repeatComponent = kappa * repeatAM;

            let Eadapt = timeComponent + costComponent + designComponent + wasteComponent + automationComponent + opsComponent + precisionComponent + co2Component + maneuverComponent + repeatComponent;

            if (droneType === "multicopter") {
                Eadapt *= 1.1;
            } else if (droneType === "fixedwing") {
                Eadapt *= 0.9;
            }

            const costAM = cTotal * 0.8;

            let interpretation = "";
            if (Eadapt > 0.7) {
                interpretation = "Аддитивное производство значительно эффективнее. Рекомендуется для данных условий.";
            } else if (Eadapt > 0.4) {
                interpretation = "Аддитивное производство предпочтительнее. Обеспечивает экономию времени, отходов и операций.";
            } else if (Eadapt > 0.2) {
                interpretation = "Требуется дополнительный анализ. Преимущества аддитивного производства неочевидны.";
            } else {
                interpretation = "Традиционное производство более эффективно для данных условий.";
            }

            document.getElementById("efficiencyValue").innerHTML = 
                `E<sub>adapt</sub> = ${Eadapt.toFixed(3)}<br>
                Доля отходов (AM): ${wasteAM.toFixed(1)}%<br>
                Доля отходов (традиц.): ${wasteTraditional.toFixed(1)}%<br>
                Выбросы CO2 (AM): ${co2AM.toFixed(1)} кг/тонну<br>
                Выбросы CO2 (традиц.): ${co2Traditional.toFixed(1)} кг/тонну<br>
                Повторяемость (AM): ${(repeatAM * 100).toFixed(1)}%<br>
                Маневренность (AM): ${(1 / setupAM).toFixed(3)} 1/дни`;
            document.getElementById("efficiencyInterpretation").textContent = interpretation;

            document.getElementById("compTimeAM").textContent = tAM;
            document.getElementById("compTimeTraditional").textContent = tTraditional;
            document.getElementById("compWasteAM").textContent = wasteAM;
            document.getElementById("compWasteTraditional").textContent = wasteTraditional;
            document.getElementById("compCO2AM").textContent = co2AM;
            document.getElementById("compCO2Traditional").textContent = co2Traditional;
            document.getElementById("compOpsAM").textContent = opsAM;
            document.getElementById("compOpsTraditional").textContent = opsTraditional;
            document.getElementById("compCostAM").textContent = costAM.toFixed(0);
            document.getElementById("compCostTraditional").textContent = cTotal.toFixed(0);
            document.getElementById("compPrecisionAM").textContent = precisionAM;
            document.getElementById("compPrecisionTraditional").textContent = precisionTraditional;
            document.getElementById("compRepeatAM").textContent = (repeatAM * 100).toFixed(1);
            document.getElementById("compRepeatTraditional").textContent = (repeatTraditional * 100).toFixed(1);
            document.getElementById("compSetupAM").textContent = (1 / setupAM).toFixed(3);
            document.getElementById("compSetupTraditional").textContent = (1 / setupTraditional).toFixed(3);
            document.getElementById("compDurabilityAM").textContent = durabilityAM;
            document.getElementById("compDurabilityTraditional").textContent = durabilityTraditional;
            document.getElementById("compEcoMatAM").textContent = ecoMatAM;
            document.getElementById("compEcoMatTraditional").textContent = ecoMatTraditional;

            document.getElementById("comparisonResult").classList.remove("hidden");
        }

        function calculateAdditive() {
            const droneType = document.getElementById("droneTypeAdd").value;
            const volume = parseInt(document.getElementById("productionVolume").value);
            const time = parseInt(document.getElementById("timeConstraint").value);
            const budget = document.getElementById("budget").value;
            const material = document.getElementById("material").value;
            const complexity = document.getElementById("complexity").value;
            const ecoPriority = document.getElementById("ecoPriority").value;
            const precisionPriority = document.getElementById("precisionPriority").value;
            const setupTime = parseInt(document.getElementById("setupTime").value);
            const durability = parseInt(document.getElementById("durability").value);
            const adjustTime = parseInt(document.getElementById("adjustTime").value);

            const criteria = ["Скорость производства", "Удобство установки", "Себестоимость изделий", "Экологичность производства", "Механо-технические свойства"];
            let weights = [0.2, 0.15, 0.25, 0.2, 0.2];
            if (ecoPriority === "high") { weights[3] += 0.05; weights[0] -= 0.05; }
            if (precisionPriority === "high") { weights[4] += 0.05; weights[1] -= 0.05; }

            const techScores = {
                "FDM": {
                    speed: 5,
                    convenience: 4,
                    cost: 5,
                    eco: 3,
                    mech: 2
                },
                "SLA": {
                    speed: 3,
                    convenience: 3,
                    cost: 3,
                    eco: 2,
                    mech: 4
                },
                "SLS": {
                    speed: 3,
                    convenience: 4,
                    cost: 3,
                    eco: 4,
                    mech: 4
                },
                "DMLS": {
                    speed: 1,
                    convenience: 2,
                    cost: 1,
                    eco: 3,
                    mech: 5
                },
                "WAAM": {
                    speed: 4,
                    convenience: 3,
                    cost: 3,
                    eco: 2,
                    mech: 3
                }
            };

            let scores = {};
            for (let tech in techScores) {
                scores[tech] = (
                    weights[0] * techScores[tech].speed +
                    weights[1] * techScores[tech].convenience +
                    weights[2] * techScores[tech].cost +
                    weights[3] * techScores[tech].eco +
                    weights[4] * techScores[tech].mech
                );
            }

            let recommendedTech = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
            let explanation = "";
            let alternatives = [];

            if (material === "metal") {
                if (budget === "high" && volume < 50) {
                    recommendedTech = "DMLS";
                    explanation = "DMLS обеспечивает высокую точность и прочность для металлических деталей малой серии.";
                    alternatives.push({ tech: "WAAM", desc: "Для крупных деталей с меньшей точностью" });
                } else {
                    recommendedTech = "WAAM";
                    explanation = "WAAM экономичен для крупных металлических деталей.";
                    alternatives.push({ tech: "DMLS", desc: "Для более точных деталей" });
                }
            } else if (material === "plastic" && time < 5 && complexity === "low") {
                recommendedTech = "FDM";
                explanation = "FDM оптимален для быстрого и дешевого производства простых пластиковых деталей.";
                alternatives.push({ tech: "SLS", desc: "Для более прочных деталей" });
            } else if (complexity === "high" || precisionPriority === "high") {
                recommendedTech = "SLA";
                explanation = "SLA обеспечивает высокую точность для сложных геометрий.";
                alternatives.push({ tech: "SLS", desc: "Для функциональных деталей" });
            } else if (ecoPriority === "high" || adjustTime < 5) {
                recommendedTech = "SLS";
                explanation = "SLS минимизирует отходы и выбросы, подходит для быстрой отладки.";
                alternatives.push({ tech: "FDM", desc: "Для дешевого производства" });
            } else {
                recommendedTech = "SLS";
                explanation = "SLS балансирует экологичность, прочность и скорость.";
                alternatives.push({ tech: "FDM", desc: "Для дешевого производства" });
            }

            if (droneType === "multicopter" && recommendedTech !== "SLA" && recommendedTech !== "DMLS") {
                recommendedTech = "SLA";
                explanation = "SLA выбрана для мультикоптеров из-за высокой точности.";
                alternatives.push({ tech: "SLS", desc: "Для прочных деталей" });
            }

            if (setupTime < 10 || durability > 15) {
                recommendedTech = "FDM";
                explanation = "FDM выбран из-за быстрой установки и высокой долговечности линии.";
                alternatives.push({ tech: "SLS", desc: "Для экологичности" });
            }

            document.getElementById("recommendedTech").textContent = recommendedTech;
            document.getElementById("techExplanation").textContent = explanation;
            document.getElementById("criteriaWeights").textContent = criteria.map((c, i) => `${c}: ${weights[i].toFixed(2)}`).join(", ");

            const alternativesDiv = document.getElementById("alternatives");
            alternativesDiv.innerHTML = "";
            if (alternatives.length > 0) {
                const ul = document.createElement("ul");
                alternatives.forEach(alt => {
                    const li = document.createElement("li");
                    li.innerHTML = `<strong>${alt.tech}</strong> - ${alt.desc}`;
                    ul.appendChild(li);
                });
                alternativesDiv.appendChild(ul);
            }

            document.getElementById("additiveResult").classList.remove("hidden");
        }
    </script>
</body>
</html>